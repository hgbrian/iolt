<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="js/d3_timeseries.js"></script>
<link rel="stylesheet" type="text/css" href="js/d3_timeseries.css"> 
</head>

<script>
//var data = [{date:new Date('2017-02-20 (00:28:31.878) PST'),t:150,h:124,t_ci_up:170,t_ci_down:100,h_ci_up:170,h_ci_down:108},];
var data = {{data|safe}};

$(function() {
var data1 = [];
for (var i=0; i<data.length; i++) {
    if (data[i]['n'] == '') {
        data1.push(data[i]);
    }
}

var chart1 = d3.timeseries()
          .addSerie(data1,{x:'date', y:'t', ci_up:'t_ci_up', ci_down:'t_ci_down'}, 
                         {interpolate:'linear', color:"#a6cee3", label:"temperature"})
          .addSerie(data1,{x:'date', y:'h', ci_up:'h_ci_up', ci_down:'h_ci_down'}, 
                         {interpolate:'linear', color:"#c6aeb3", label:"humidity"})
          .width(1200)
chart1('#chart1')

var data2 = [];
for (var i=0; i<data.length; i++) {
    if (data[i]['n'] == 'dht22') {
        data2.push(data[i]);
    }
}

var chart2 = d3.timeseries()
          .addSerie(data2,{x:'date', y:'t', ci_up:'t_ci_up', ci_down:'t_ci_down'}, 
                         {interpolate:'linear', color:"#a6cee3", label:"temperature"})
          .addSerie(data2,{x:'date', y:'h', ci_up:'h_ci_up', ci_down:'h_ci_down'}, 
                         {interpolate:'linear', color:"#c6aeb3", label:"humidity"})
          .width(1200)
chart2('#chart2')
});

</script>

<body>
<h1>Temperature and Humidity</h1>
<div id="chart1"></div>
<div id="chart2"></div>
</body>
</html>
